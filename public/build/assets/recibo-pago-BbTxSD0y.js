let o;document.addEventListener("DOMContentLoaded",()=>{var m,u;const l=document.getElementById("modalReciboDetalle");if(!l)return;const b=new bootstrap.Modal(l),e=a=>document.querySelector(a),n=(a,t)=>(a==null?void 0:a.dataset[t])||"";o=new TableRowSelector(".table-row-selectable","btnAbrirRecibo","recibo"),(m=e("#btnAbrirRecibo"))==null||m.addEventListener("click",()=>{const a=o==null?void 0:o.getSelectedValue(),t=a&&e(`tr[data-recibo="${a}"]`);t&&(e("#modalReciboNumero").textContent=n(t,"numero"),e("#modalMonto").value=n(t,"monto"),e("#modalEstado").value=n(t,"estado")||"pendiente",e("#modalObservacion").value=n(t,"observacion"),e("#modalReciboId").value=n(t,"reciboId"),e("#pdfViewer").src=`/recibos/pdf/${n(t,"reciboId")}`,b.show())}),(u=e("#btnGuardar"))==null||u.addEventListener("click",async()=>{const a=document.getElementById("modalReciboId"),t=document.getElementById("modalEstado"),g=document.getElementById("modalObservacion"),p=a?a.value:null,c=t?t.value:null,s=g&&g.value||"";if(c==="rechazado"&&!s.trim())return alert("Tiene que ingresar el motivo del rechazo del pago");try{const v=await(await fetch(`/recibos/actualizar-estado/${p}`,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e('meta[name="csrf-token"]').content},body:JSON.stringify({estado:c,observacion:s})})).json();if(!v.success)return alert(v.message||"Error al actualizar");const d=e(`tr[data-recibo="${o==null?void 0:o.getSelectedValue()}"]`);if(d){const r=d.querySelector(".badge"),f={aceptado:"bg-success",rechazado:"bg-danger",pendiente:"bg-warning"},E={aceptado:"Aceptado",rechazado:"Rechazado",pendiente:"Pendiente"};r&&(r.className=`badge ${f[c]}`,r.textContent=E[c]),d.dataset.estado=c,d.dataset.observacion=s,d.classList.remove("table-primary","selected")}const i=e("#successNotification");i&&(e("#successMessage").textContent="Estado actualizado correctamente",i.style.display="block",setTimeout(()=>i.style.display="none",3e3)),b.hide(),o==null||o.clearSelection(),e("#btnAbrirRecibo").disabled=!0}catch{}})});
